# ExoMiner

[//]: # (![ExoMiner Logo.]&#40;/others/images/exominer_logo.png&#41;)
<div style="text-align: center;">
    <img src="/others/images/exominer_logo.png" width="250" height="250" alt="Exominer Logo">
</div>

#### Written by [Miguel Martinho](https://migmartinho.github.io) (miguel.martinho@nasa.gov)

## Introduction

This project's mission is to develop, test, and deploy automated machine learning-based methods to sift ('mine') through 
transit photometry data from exoplanet survey missions such as Kepler and TESS and inform subject matter experts (SMEs) 
on potential transiting planet candidates.

### Current main goals

The main goals of the `ExoMiner` project are:

1. Perform classification of transit signals in Kepler and TESS data;
2. Create vetted catalogs of Threshold Crossing Events (TCEs) for Kepler and TESS sector runs/cycles.
3. Validate new exoplanets in Kepler and TESS.

## ExoMiner Pipeline [**NEW**]

The [ExoMiner Pipeline](/exominer_pipeline) is a fully integrated pipeline from TIC IDs to ExoMiner prediction scores 
for the corresponding 
TESS SPOC TCEs in 2-min/FFI data. This pipeline makes use of Podman as a container framework to provide a seamless 
experience to the user - no need for setting up the code repository and install package dependencies! Simply get the 
Podman image for your system's architecture using the [manifest](/docs/getting-started.md#pulling-the-image). See the 
documentation in [here](/docs/index.md) to get started.

For those interested in running the pipeline without resorting to Podman, see 
[Running the pipeline without Podman](/docs/running-exominer-pipeline.md#running-the-pipeline-without-podman).

## Repository Overview

The repository consists of the following main blocks:

1. Data preprocessing: preprocess data products (e.g. light curve FITS files) to generate a catalog of transit signal 
features to be used for training and evaluating models, and to run inference on it. Code under
[src_preprocessing](/src_preprocessing).
2. Model training/evaluation/prediction: train and evaluate models on the preprocessed data. Run inference on the data 
using trained models. Code under [src](/src).
3. Model evaluation using cross-validation under [src_cv](/src_cv).
4. Hyperparameter Optimization: use code under [src_hpo](src_hpo) to run hyperparameter optimization experiments to 
find an optimized architecture for a given task.
5. Model Development: use code under [models](models) to access and modify ExoMiner architectures. 

## Source Data

All data used in this project are publicly available. Generally, the data used consist of:

- TCE and Objects of Interest (e.g. KOI and TOI catalogs) tables available in archives/respositories such as
  [NExSci](https://exoplanetarchive.ipac.caltech.edu/),
  [ExoFOP](https://exofop.ipac.caltech.edu/), [TEV](https://tev.mit.edu/data/) and
  [MAST](https://archive.stsci.edu/);
- Light curve and target pixel FITS files and other data products generated by the TESS Science Processing Operations 
- Center (SPOC) pipeline available in archives such as the [MAST](https://archive.stsci.edu/).

## Models

Models currently implemented in [models](models/models_keras.py):

1. `ExoMiner++` [**CURRENT**]: Improved architecture for TESS. Used in TESS paper (see [References](#references)).

![ExoMiner++ architecture.](others/images/exominer_architecture_tess.png)

2. `ExoMiner`Multi-branch Convolutional Neural Network (CNN) whose design is inspired in the different diagnostic
   tests used in the Data Validation (DV) module of the SPOC pipeline. Used in the Kepler paper and multiplicity boost 
    work for Kepler data (see [References](#references))

![ExoMiner architecture.](others/images/exominer_architecture_kepler.png)

[//]: # (2. Astronet: see https://github.com/google-research/exoplanet-ml and Shallue, Christopher J., and Andrew Vanderburg. ")

[//]: # (   Identifying exoplanets with deep learning: A five-planet resonant chain around kepler-80 and an eighth planet around)

[//]: # (   kepler-90." The Astronomical Journal 155.2 &#40;2018&#41;: 94.)

[//]: # (3. Exonet: see Ansdell, Megan, et al. "Scientific domain knowledge improves exoplanet transit classification with deep)

[//]: # (   learning." The Astrophysical journal letters 869.1 &#40;2018&#41;: L7.)

[//]: # (4. Exonet-XS: see Ansdell, Megan, et al. "Scientific domain knowledge improves exoplanet transit classification with)

[//]: # (   deep learning." The Astrophysical journal letters 869.1 &#40;2018&#41;: L7. 5 MLP: Multi-layer Perceptron.)

## References

For more detailed information see the following publications:
- ExoMiner on Kepler Data ["ExoMiner: A Highly Accurate and Explainable Deep Learning Classifier that Validates 301 New Exoplanets"](https://iopscience.iop/articl/10.3847/1538-4357/ac4399/), published 2022 February 17 in the Astrophysical Journal, Volume 926, Number 2.
- ExoMiner with Multiplicity Boost for Kepler ["Multiplicity Boost of Transit Signal Classifiers: Validation of 69 New Exoplanets using the Multiplicity Boost of ExoMiner"](https://iopscience.iop.org/article/10.3847/1538-3881/acd344/), published 2023 June 26 in the Astronomical Journal, Volume 166, Number 1.
- ExoMiner for TESS 2-min Data ["ExoMiner++: Enhanced Transit Classification and a New Vetting Catalog for 2-Minute TESS Data"](https://doi.org/10.48550/arXiv.2502.09790) [**under review for ApJ**]
  - **Data repository on Zenodo**: [here](https://doi.org/10.5281/zenodo.15466292)
  - **Interactive vetting catalog**: [here](http://exominer-vetter-tess-pc-catalog.onrender.com/)

## Credits

This work was developed by members of the Data Sciences Group, DASH, Intelligent Systems Division (Code-TI) at NASA Ames 
Research Center (NASA ARC).

- Main Contributors
  - Hamed Valizadegan<sup>1,2</sup> (PI), hamed.valizadegan@nasa.gov
  - Miguel Martinho<sup>1,2</sup> (Co-I), miguel.martinho@nasa.gov

- Collaborators
  - Active Collaborators
      - Doug Caldwell<sup>1,3</sup>
      - Jon Jenkins<sup>1,3</sup>
      - Joseph Twicken<sup>1,3</sup>
    
  - Past Collaborators
    - Stephen Bryson<sup>1</sup>
    - Jeff Smith<sup>1,3</sup>
  
- Developers
  - Active Developers
      - Josue Ochoa<sup>7</sup> (Transit Detection)
    
  - Past Developers 
      - Andr√©s Carranza <sup>2,5</sup> (Unfolded phase time series for transit signal classification)
      - Fellipe Marcellino<sup>2</sup> (Transit detection using Kepler data)
      - Jennifer Andersson<sup>4</sup> (Kepler to TESS transfer learning)
      - Kaylie Hausknecht<sup>2,6</sup> (Explainability framework using Kepler data)
      - Laurent Wilkens<sup>2</sup> (Kepler)
      - Martin Koeling<sup>4</sup> (Kepler to TESS transfer learning)
      - Nikash Walia<sup>2</sup> (Kepler)
      - Noa Lubin <sup>4</sup> (Kepler)
      - Pedro Gerum<sup>4</sup> (Kepler, Kepler non-TCE classification)
      - Patrick Maynard<sup>2,5,7</sup> (Kepler to TESS transfer learning)
      - Sam Donald<sup>4</sup> (Kepler to TESS transfer learning)
      - Theng Yang<sup>2,7</sup> (Label noise detection in Kepler data)
      - Hongbo Wei<sup>2,6,7</sup> (Kepler non-TCE classification, KOI classification, Kepler to TESS transfer learning)
      - Stuti Agarwal <sup>6</sup> (Difference image)
      - Joshua Belofsky <sup>2,5</sup> (Difference image)
      - Charles Yates <sup>2,5</sup> (Unfolded phase time series for transit signal classification, Kepler to TESS 
      transfer learning)
      - William Zhong <sup>5</sup> (Difference Image)
      - Ashley Raigosa<sup>7</sup> (TESS SPOC FFI)
      - Saiswaroop Thammineni<sup>7</sup> (Transit Encoding)
      - Kunal Malhotra<sup>7</sup> (Transit Detection)
      - Eric Liang<sup>7</sup> (Transit Encoding)
      - Ujjawal Prasad<sup>8</sup> (Transit Detection)
      - Adithya Giri<sup>7</sup> (Brown Dwarfs vs Planets Classification; Structured and Adversarial Training for Transit 
       Classification Robustness)

1 - NASA Ames Research Center (NASA ARC)\
2 - Universities Space Research Association (USRA)\
3 - The SETI Institute\
4 - NASA International Internship Program (NASA I<sup>2</sup>)\
5 - NASA Internships, Fellowships & Scholarships (NIFS)\
6 - Volunteer Internship Program (VIP)\
7 - NASA Office of STEM Engagement (OSTEM)\
8 - NASA-Chabot High School Learning Experience (NASA-CHSLE)

## Acknowledgements

We would like to acknowledge people that in some way supported our efforts:

- David Armstrong for an insightful discussion that improved our work.
- Megan Ansdell for providing information on their code and work.
- The main contributors (HV and MM) are supported through TESS XRP 2022 contract 22-XRP22 2-0173, NASA Academic Services 
Mission (NAMS) contract number NNA16BD14C as well as the Intelligent Systems Research and Development 3 (ISRDS-3) 
Contract 80ARC020D0010.
- Resources supporting this work were provided by the NASA High-End Computing (HEC) Program through the NASA Advanced 
Supercomputing (NAS) Division at Ames Research Center.
- This work has made use of data products created by the Kepler/TESS Science Processing Operations Center (SPOC) 
pipeline at NASA Ames Research Center.
- This work has made use of data from the European Space Agency (ESA) mission Gaia (https://www.cosmos.esa.int/gaia), 
processed by the Gaia Data Processing and Analysis Consortium 
(DPAC, https://www.cosmos.esa.int/web/gaia/dpac/consortium). Funding for the DPAC has been provided by national 
institutions, in particular the institutions participating in the Gaia Multilateral Agreement.
- This work includes data collected by the TESS mission. Funding for the TESS mission is provided by the NASA's Science 
Mission Directorate.
- This research is based on observations made with the NASA/ESA Hubble Space Telescope obtained from the Space Telescope 
Science Institute, which is operated by the Association of Universities for Research in Astronomy, Inc., under NASA 
contract NAS 5‚Äì26555.
- This research has made use of the NASA Exoplanet Archive, which is operated by the California Institute of Technology, 
under contract with the National Aeronautics and Space Administration under the Exoplanet Exploration Program.
- This research has made use of the Exoplanet Follow-up Observation Program website, which is operated by the California 
Institute of Technology, under contract with the National Aeronautics and Space Administration under the Exoplanet 
Exploration Program.
- This paper includes data collected by the Kepler and TESS missions, which are publicly available from the Mikulski 
Archive for Space Telescopes (MAST).

[//]: # (- This work made use of the [gaia-kepler.fun]&#40;https://gaia-kepler.fun&#41; crossmatch database created by Megan Bedell.)
## Contacts
- Hamed Valizadegan (PI),  hamed.valizadegan@nasa.gov
- Miguel Martinho (Co-I), miguel.martinho@nasa.gov
- Nikunj Oza (Group Lead, NASA ARC), nikunj.c.oza@nasa.gov

## Release Notes

Second release of ExoMiner (v2.0). Expected features to be added in subsequent releases:
- TBD.

See the [NASA Open Source Agreement (NOSA)](others/licenses/nasa_open_source_agreement_ExoMiner-18792-1.pdf) for this software release.

For external collaborators, see the 
[Individual](ExoMiner_ARC-18792-1_Individual%20CLA.pdf) and [Corporate](others/licenses/Corporate_CLA_ExoMiner_ARC-18792-1.pdf) 
Contributor License Agreements.

* * * * * * * * * * * * * * 
Notices:

Copyright ¬© 2024 United States Government as represented by the Administrator of the National Aeronautics and Space 
Administration.  All Rights Reserved.

Disclaimers

No Warranty: THE SUBJECT SOFTWARE IS PROVIDED "AS IS" WITHOUT ANY WARRANTY OF ANY KIND, EITHER EXPRESSED, IMPLIED, OR 
STATUTORY, INCLUDING, BUT NOT LIMITED TO, ANY WARRANTY THAT THE SUBJECT SOFTWARE WILL CONFORM TO SPECIFICATIONS, ANY 
IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR FREEDOM FROM INFRINGEMENT, ANY WARRANTY 
THAT THE SUBJECT SOFTWARE WILL BE ERROR FREE, OR ANY WARRANTY THAT DOCUMENTATION, IF PROVIDED, WILL CONFORM TO THE 
SUBJECT SOFTWARE. THIS AGREEMENT DOES NOT, IN ANY MANNER, CONSTITUTE AN ENDORSEMENT BY GOVERNMENT AGENCY OR ANY PRIOR 
RECIPIENT OF ANY RESULTS, RESULTING DESIGNS, HARDWARE, SOFTWARE PRODUCTS OR ANY OTHER APPLICATIONS RESULTING FROM USE 
OF THE SUBJECT SOFTWARE.  FURTHER, GOVERNMENT AGENCY DISCLAIMS ALL WARRANTIES AND LIABILITIES REGARDING THIRD-PARTY 
SOFTWARE, IF PRESENT IN THE ORIGINAL SOFTWARE, AND DISTRIBUTES IT "AS IS."

Waiver and Indemnity:  RECIPIENT AGREES TO WAIVE ANY AND ALL CLAIMS AGAINST THE UNITED STATES GOVERNMENT, ITS 
CONTRACTORS AND SUBCONTRACTORS, AS WELL AS ANY PRIOR RECIPIENT.  IF RECIPIENT'S USE OF THE SUBJECT SOFTWARE RESULTS IN 
ANY LIABILITIES, DEMANDS, DAMAGES, EXPENSES OR LOSSES ARISING FROM SUCH USE, INCLUDING ANY DAMAGES FROM PRODUCTS BASED 
ON, OR RESULTING FROM, RECIPIENT'S USE OF THE SUBJECT SOFTWARE, RECIPIENT SHALL INDEMNIFY AND HOLD HARMLESS THE UNITED 
STATES GOVERNMENT, ITS CONTRACTORS AND SUBCONTRACTORS, AS WELL AS ANY PRIOR RECIPIENT, TO THE EXTENT PERMITTED BY LAW.  
RECIPIENT'S SOLE REMEDY FOR ANY SUCH MATTER SHALL BE THE IMMEDIATE, UNILATERAL TERMINATION OF THIS AGREEMENT. 

* * * * * * * * * * * * * * 